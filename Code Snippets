Code Snippets:
Frontend
Frontend/src/components/layout.jsx
import React from 'react'
import Header from './header'
import '../App.css'
const Layout = (props) => {
return (
<div>
<Header />
<div>{props.children}</div>
</div>
)
}
export default Layout
Frontend/src/components/productsList.jsx
import { Link } from 'react-router-dom'
import { useContext } from 'react'
import CartContext from '../Context/CartContext'
import '../styles/prodsComponent.css'
const ProductList = (props) => {
const { productName, id, image, price } = props.prods
const { addToCart } = useContext(CartContext)
const handleAddToCart = () => {
addToCart(props.prods)
alert('Item added to cart')
}
return (
<>
<div className='card'>
<Link style={{ color: 'white' }} to={`/products/${id}`}>
<img src={image} alt={id} className='image' />
<h4>{productName}</h4>
</Link>
<h6>${price}</h6>
<button className='btn btn-primary' onClick={handleAddToCart}>
Add To Cart
</button>
</div>
</>
)
}
export default ProductList
Frontend/src/components/ProtectedRoute.jsx
import React from 'react';
import Cookies from 'js-cookie';
import { Route, Redirect } from 'react-router-dom';
const ProtectedRoute = ({ component: Component, ...rest }) => {
const jwtToken = Cookies.get('jwtToken');
console.log('jwt token in pr:',jwtToken);
return (
<Route
{...rest}
render={(props) =>
jwtToken ? (
<Component {...props} />
) : (
<Redirect to="/login" />
)
}
/>
);
};
export default ProtectedRoute;
Frontend/src/context/CartContext.jsx
import React, { createContext, useState, useEffect } from 'react'
const CartContext = createContext()
const cartFromLocal = JSON.parse(localStorage.getItem('cartItems')) || []
export const CartProvider = ({ children }) => {
const [cartItems, setCartItems] = useState(cartFromLocal)
useEffect(() => {
localStorage.setItem('cartItems', JSON.stringify(cartItems))
}, [cartItems])
const clearItem = (product) => {
const newCart = cartItems.filter((item) => item.id !== product.id)
return setCartItems(newCart)
}
const removeOneItem = (product) => {
const existingItemIndex = cartItems.findIndex(
(item) => item.id === product.id,
)
if (product.quantity > 1) {
if (existingItemIndex !== -1) {
setCartItems(
cartItems.map((item, index) => {
if (index === existingItemIndex) {
return {
...item,
quantity: item.quantity - 1,
price: product.price - item.realPrice,
}
}
return item
}),
)
}
} else {
const newCart = cartItems.filter((item) => item.id !== product.id)
return setCartItems(newCart)
}
}
const addToCart = (product) => {
// Check if product already exists in cart
const existingItemIndex = cartItems.findIndex(
(item) => item.id === product.id,
)
if (existingItemIndex !== -1) {
// Update quantity
setCartItems(
cartItems.map((item, index) => {
if (index === existingItemIndex) {
return {
...item,
quantity: item.quantity + 1,
price: (item.quantity + 1) * product.realPrice,
}
}
return item
}),
)
} else {
// Add new item
setCartItems([
...cartItems,
{
id: product.id,
quantity: 1,
name: product.productName,
image: product.image,
price: product.price,
realPrice: product.price,
},
])
}
}
// Other cart management functions (e.g., removeItem, clearCart)
return (
<CartContext.Provider
value={{ cartItems, addToCart, clearItem, removeOneItem }}>
{children}
</CartContext.Provider>
)
}
export default CartContext
Frontend/src/pages/cart.jsx
import React, { useContext } from 'react'
import Layout from '../components/layout'
import CartContext from '../Context/CartContext'
import '../styles/cart.css'
import { Link } from 'react-router-dom'
import { RiDeleteBin5Fill } from 'react-icons/ri'
function Cart() {
const { cartItems, clearItem, addToCart, removeOneItem } =
useContext(CartContext)
return (
<Layout>
<div className='cart-container'>
<h1>Cart</h1>
{cartItems.length > 0 ? (
<>
<table>
<thead>
<tr>
<th>Product</th>
<th>Price</th>
<th>Quantity</th>
<th>Subtotal</th>
<th>Action</th>
<th></th>
</tr>
</thead>
<tbody>
{cartItems.map((item) => (
<tr key={item.id}>
<td>
<img
src={item.image}
alt={item.name}
width='80px'
height='50px'
/>
<Link to={`/products/${item.id}`}> {item.name}</Link>
</td>
<td>{item.price}</td>
<td>{item.quantity}</td>
<td>{item.price}</td>
<td>
<button
className='btn btn-secondary'
onClick={() => {
addToCart(item)
}}>
+
</button>
<button
className='btn btn-secondary'
onClick={() => removeOneItem(item)}>
-
</button>
</td>
<td>
<button
className='btn btn-primary'
onClick={() => clearItem(item)}>
<RiDeleteBin5Fill />
</button>
</td>
</tr>
))}
</tbody>
<tfoot>
<tr>
<td colSpan='4'>Total</td>
<td>
{cartItems
.reduce((total, item) => total + item.price, 0)
.toFixed(2)}
</td>
</tr>
</tfoot>
</table>
<button className='btn btn-danger'>Checkout</button>
</>
) : (
<div className='nothing-container'>
<h4>Cart is Empty</h4>
</div>
)}
</div>
</Layout>
)
}
export default Cart
Frontend/src/pages/detailspage.jsx
import React, { useEffect, useState } from 'react';
import Layout from '../components/layout';
import axios from 'axios';
import Cookies from 'js-cookie';
import { TailSpin } from 'react-loader-spinner';
import '../styles/prodsComponent.css';
// Centralize backend URL
const BACKEND_URL = 'https://ecommerce-be-x0ow.onrender.com';
const DetailsPage = (props) => {
const [details, setDetails] = useState(null); // Initial state is null for better handling
const [loading, setLoading] = useState(true); // State for loading spinner
const [errorMessage, setErrorMessage] = useState(''); // State for error messages
useEffect(() => {
const getData = async () => {
const { match } = props;
const id = match.params.id;
const token = Cookies.get('jwtToken');
if (!token) {
setErrorMessage('You are not authorized. Please log in.');
setLoading(false);
return;
}
try {
const response = await axios.get(`${BACKEND_URL}/api/products/${id}`, {
headers: { authorization: `Bearer ${token}` },
});
setDetails(response.data);
} catch (error) {
console.error(error);
if (error.response && error.response.status === 401) {
setErrorMessage('Authorization failed. Please log in again.');
} else if (error.response && error.response.status === 404) {
setErrorMessage('Product not found.');
} else {
setErrorMessage('Failed to fetch product details. Please try again later.');
}
} finally {
setLoading(false);
}
};
getData();
// eslint-disable-next-line react-hooks/exhaustive-deps
}, []);
const loadingScreen = () => (
<div className="loader-container">
<TailSpin color="#00BFFF" height={100} width={100} />
</div>
);
const errorScreen = () => (
<div className="error-message">
<h2>{errorMessage}</h2>
</div>
);
const productDetails = () => (
<div className="product-view">
<div className="views">
<img
src={details.image}
alt={details.productName}
width="350px"
height="300px"
/>
</div>
<div>
<h3>{details.productName}</h3>
<p>{details.description}</p>
<p>Price: ${details.price}</p>
<p>Ram: {details.specs.ram}</p>
<p>Storage: {details.specs.storage}</p>
</div>
</div>
);
return (
<Layout>
<div className="details-container">
{loading ? loadingScreen() : errorMessage ? errorScreen() : productDetails()}
</div>
</Layout>
);
};
export default DetailsPage;
Frontend/src/pages/error.jsx
import React from 'react'
import '../App.css'
const Error = () => {
return (
<div className='layout'>
<h1>Error 404</h1>
<p>Page not found</p>
</div>
)
}
export default Error
Frontend/src/pages/home.jsx
import React from 'react'
import Layout from '../components/layout'
import { TypeAnimation } from 'react-type-animation'
import '../styles/home.css'
const list = [
"Customization like never before: Choose from a curated selection of components or unleash your
inner engineer with our build-your-own platform. We'll make sure every piece fits flawlessly.",
"Expert guidance: Our knowledgeable team is always here to assist you, answer your questions, and
recommend the perfect setup for your needs and budget.",
"More than just hardware: We don't stop at the PC. We offer a wide range of peripherals, software,
and accessories to complete your ultimate battlestation or workspace.",
"Unmatched support: We stand behind our products with industry-leading warranties and
responsive customer service, ensuring you're never left in the dark.",
]
const Home = () => {
const bulletPoint = (props, i) => {
return (
<ul key={i}>
<p>{props}</p>
</ul>
)
}
const lander = () => {
return (
<Layout>
<div className='home-bg-container'>
<div className='h-container'>
<TypeAnimation
sequence={[
'Welcome to Dev Store.',
2000,
'Welcome to One Stop Store.',
2000,
'Welcome to The Game World.',
2000,
]}
wrapper='h1'
cursor={true}
repeat={Infinity}
className='style-heading'
/>
</div>
<div className='about-container'>
<h1>About Us</h1>
<p>
We're not just another tech store. We're passionate about building
dream machines that empower you to create, conquer, and connect.
Whether you're a seasoned gamer, a content creator on the rise, or
a professional pushing the boundaries of productivity, we believe
everyone deserves a PC tailored to their unique needs and
ambitions. Our story began with a simple passion: to make
high-performance PCs accessible to everyone. We saw the
frustration of gamers facing overpriced pre-builts or the daunting
task of navigating compatibility when building their own. So, we
decided to bridge the gap.
</p>
<div className='align-about'>
{list.map((eachItem, i) => {
return bulletPoint(eachItem, i)
})}
</div>
</div>
</div>
</Layout>
)
}
return lander()
}
export default Home
Frontend/src/pages/login.jsx
import { useState } from 'react'
import { useHistory, Redirect } from 'react-router-dom'
import Cookies from 'js-cookie'
import axios from 'axios'
import '../styles/landingpage.css'
import { TailSpin } from 'react-loader-spinner'
const LandingPage = () => {
const [showLogin, setShowLogin] = useState(true)
const [username, setUsername] = useState('')
const [password, setPassword] = useState('')
const [email, setEmail] = useState('')
const [phone, setPhone] = useState('')
const [showMessage, setShowMessage] = useState('')
const [loading, setLoading] = useState(false)
const history = useHistory()
const loginSuccess = (token) => {
Cookies.set('jwtToken', token, { expires: 30 })
history.replace('/')
}
const verifyLogin = async (e) => {
e.preventDefault()
if (username === '' || password === '') {
return setShowMessage('Please enter username and password')
}
setLoading(true)
const encoded = btoa(password)
await axios
.post('https://devstorebhargav.onrender.com/api/login', {
username,
password: `${encoded}`,
})
.then((res) => {
const token = res.data.token
loginSuccess(token)
})
.catch((e) => {
console.log(e)
setShowMessage(e.response.data)
setLoading(false)
})
setUsername('')
setPassword('')
}
const registerUser = async (e) => {
e.preventDefault()
if (username === '' || password === '' || email === '' || phone === '') {
return setShowMessage('Please enter all the details')
}
await axios
.post('https://devstorebhargav.onrender.com/api/register', {
username,
password,
email,
phone,
})
.then((res) => {
alert(res.data)
})
.catch((e) => {
console.log(e)
setShowMessage(e.response.data)
})
setUsername('')
setPassword('')
setEmail('')
setPhone('')
}
const loginForm = () => {
return (
<form className='login-card'>
<input
id='username'
required={true}
type='text'
placeholder='Username'
value={username}
onChange={(e) => setUsername(e.target.value)}
/>
<input
id='password'
type='password'
required={true}
placeholder='Password'
value={password}
onChange={(e) => setPassword(e.target.value)}
/>
<div>
<span onClick={() => setShowLogin(false)}>Not a User? signUp</span>
</div>
<div>{showMessage}</div>
<button type='submit' onClick={verifyLogin}>
Login
</button>
</form>
)
}
const registerForm = () => {
return (
<form className='register-card'>
<input
id='username'
required={true}
type='text'
placeholder='Username'
value={username}
onChange={(e) => setUsername(e.target.value)}
/>
<input
id='password'
type='password'
required={true}
placeholder='Password'
value={password}
onChange={(e) => setPassword(e.target.value)}
/>
<input
id='email'
type='email'
required={true}
placeholder='email'
value={email}
onChange={(e) => setEmail(e.target.value)}
/>
<input
id='phone'
type='tel'
placeholder='Mobile Number'
value={phone}
onChange={(e) => setPhone(e.target.value)}
/>
<div>
<span onClick={() => setShowLogin(true)}>Already a User? Login</span>
</div>
<div>{showMessage}</div>
<button type='submit' onClick={registerUser}>
Submit
</button>
</form>
)
}
const jwtToken = Cookies.get('jwtToken')
if (jwtToken !== undefined) {
return <Redirect to='/' />
} else {
if (loading) {
return (
<div className='loader-container'>
<TailSpin color='#00BFFF' height={100} width={100} />
</div>
)
} else {
return (
<div className='main-container'>
{showLogin ? loginForm() : registerForm()}
</div>
)
}
}
}
export default LandingPage
Frontend/src/pages/products.jsx
import React, { useEffect, useState } from 'react'
import axios from 'axios'
import Layout from '../components/layout'
import ProductList from '../components/productsList'
import '../styles/products.css'
import Cookies from 'js-cookie'
import { TailSpin } from 'react-loader-spinner'
const Products = () => {
const [productList, setProductList] = useState([])
useEffect(() => {
const getData = async () => {
const jwtToken = Cookies.get('jwtToken')
await axios
.get('https://devstorebhargav.onrender.com/api/products', {
headers: { authorization: `Bearer ${jwtToken}` },
})
.then((res) => {
setProductList(res.data)
console.log(productList)
})
.catch((e) => {
console.log(e)
})
}
getData()
// eslint-disable-next-line react-hooks/exhaustive-deps
}, [])
const loadingScreen = () => {
return (
<div className='loader-container'>
<TailSpin color='#00BFFF' height={100} width={100} />
</div>
)
}
return (
<Layout>
<div className='product-container'>
<h1>products</h1>
{productList.length < !0 ? (
loadingScreen()
) : (
<div className='card-container'>
{productList.map((item) => {
return <ProductList key={item.id} prods={item} />
})}
</div>
)}
</div>
</Layout>
)
}
export default Products
Frontend/src/styles/cart.css
.cart-container {
background-color: #0f0f0f;
height: 100vh;
width: 100vw;
color: white;
overflow-y: scroll;
padding: 10px;
display: flex;
flex-direction: column;
align-items: center;
gap: 10px;
}
.card-container {
display: flex;
justify-content: center;
gap: 30px;
}
.cart-card {
display: flex;
gap: 20px;
border-style: solid;
padding: 10px;
border-width: 1px;
}
table {
width: 50vw;
border-collapse: collapse;
border: 1px solid #ddd;
}
thead th {
padding: 10px;
text-align: left;
font-weight: bold;
}
tbody td {
padding: 10px;
border-bottom: 1px solid #ddd;
}
tfoot {
font-weight: bold;
}
.nothing-container {
background-color: #0f0f0f;
height: 100vh;
width: 100vw;
color: white;
padding: 10px;
display: flex;
flex-direction: column;
align-items: center;
gap: 10px;
}
Frontend/src/styles/home.css
.h-container {
display: flex;
align-items: center;
justify-content: center;
padding: 10px;
background-image: url('../../public/wave-haikei_3.png');
background-repeat: no-repeat;
background-size: cover;
background-position: bottom;
width: 100vw;
height: 65vh;
}
.style-heading {
background: linear-gradient(
90deg,
rgb(16, 16, 180) 0%,
rgba(0, 212, 255, 1) 100%
);
width: fit-content;
color: transparent;
background-clip: text;
overflow: hidden;
}
.home-bg-container {
display: flex;
flex-direction: column;
justify-content: flex-start;
background-color: #0f0f0f;
height: 100%;
}
.loader-container {
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
background-color: #0f0f0f;
height: 100vh;
padding: 0;
}
.about-container {
background-image: url('../../public/wave-haikeiInvert.png');
background-repeat: no-repeat;
background-position: top;
background-size: cover;
height: 100%;
display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
color: #e2e2e2;
text-align: center;
padding-left: 30px;
padding-right: 30px;
padding-top: 20%;
}
.align-about {
display: flex;
flex-wrap: wrap;
gap: 10px;
padding-left: 10px;
}
.align-about ul {
width: 240px;
align-self: center;
}
@media screen and (max-width: 567px) {
.align-about ul {
width: 230px;
text-align: center;
}
.about-container {
padding-top: 50%;
}
}
@media screen and (max-width: 445px) {
.align-about ul {
width: 160px;
text-align: center;
}
.about-container {
padding-top: 120%;
}
}
Frontend/src/styles/Landingpage.css
.main-container {
background-image: url('../../public/polygon-scatter-haikei.png');
height: 100vh;
overflow: scroll;
display: flex;
align-items: center;
justify-content: center;
}
.register-card {
display: flex;
flex-direction: column;
justify-content: center;
background-color: #297ea6;
padding: 20px;
gap: 10px;
height: 340px;
width: 350px;
border-radius: 8px;
box-shadow: 0 15px 20px rgba(0, 0, 0, 0.1), 0 15px 20px rgba(0, 0, 0, 0.2);
}
.login-card {
display: flex;
flex-direction: column;
justify-content: center;
background-color: #297ea6;
padding: 30px;
gap: 10px;
height: 300px;
width: 300px;
border-radius: 8px;
box-shadow: 0 15px 20px rgba(0, 0, 0, 0.1), 0 15px 20px rgba(0, 0, 0, 0.2);
}
.register-card input {
height: 35px;
border-radius: 3px;
border-width: 1px;
}
.login-card input {
height: 35px;
border-radius: 3px;
border-width: 1px;
}
input::placeholder {
color: black;
}
.register-card button {
align-self: center;
height: 30px;
width: 120px;
color: #fffcfc;
border-width: 0px;
border-radius: 3px;
background-color: #001829;
}
.login-card button {
align-self: center;
height: 30px;
width: 120px;
color: #fffcfc;
border-width: 0px;
border-radius: 3px;
background-color: #001829;
}
span {
text-decoration: underline;
color: white;
}
.loader-container {
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
background-color: #0f0f0f;
height: 100vh;
padding: 0;
}
Frontend/src/styles/prodsComponent.css
.image {
height: 180px;
width: 320px;
margin-top: 10px;
border-radius: 10px;
}
.card {
display: flex;
flex-direction: column;
align-items: center;
background-color: #475a77;
width: 340px;
height: 330px;
border-radius: 10px;
color: #e2e2e2;
text-decoration: none;
}
.card p {
font-size: 10px;
}
.details-container {
background-color: #0f0f0f;
color: #e2e2e2;
height: 100vh;
padding: 10px;
}
.product-view {
display: flex;
gap: 10px;
}
.views {
display: flex;
flex-direction: column;
}
Frontend/src/styles/products.css
.product-container {
background-color: #0f0f0f;
height: 100vh;
overflow: scroll;
width: 100vw;
color: #e2e2e2;
padding: 10px;
text-align: center;
display: flex;
flex-direction: column;
align-items: center;
}
.card-container {
display: flex;
justify-content: center;
flex-wrap: wrap;
gap: 20px;
}
Frontend/src/App.css
.layout {
background-color: #0f0f0f;
color: #e2e2e2;
height: 100vh;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
}
Frontend/src/App,js
import { Switch, Route, Redirect } from 'react-router-dom'
import LandingPage from './pages/login'
import Home from './pages/home'
import ProtectedRoute from './components/ProtectedRoute'
import Products from './pages/products'
import Cart from './pages/cart'
import DetailsPage from './pages/detailsPage'
import Error from './pages/error'
function App() {
return (
<Switch>
<Route exact path='/login' component={LandingPage} />
<ProtectedRoute exact path='/' component={Home} />
<ProtectedRoute exact path='/products' component={Products} />
<ProtectedRoute exact path='/products/:id' component={DetailsPage} />
<ProtectedRoute exact path='/cart' component={Cart} />
<Route exact path='/404-Error' component={Error} />
<Redirect to='/404-Error' />
</Switch>
)
}
export default App
Frontend/src/index.css
body {
margin: 0;
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
sans-serif;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
code {
font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
monospace;
}
Frontend/src/index.js
import React from 'react'
import ReactDOM from 'react-dom/client'
import { BrowserRouter } from 'react-router-dom'
import './index.css'
import App from './App'
import { CartProvider } from './Context/CartContext'
const root = ReactDOM.createRoot(document.getElementById('root'))
root.render(
<React.StrictMode>
<BrowserRouter>
<CartProvider>
<App />
</CartProvider>
</BrowserRouter>
</React.StrictMode>,
)
Frontend/Package.json
{
"name": "frontend",
"version": "0.1.0",
"private": true,
"homepage": ".",
"dependencies": {
"@babel/plugin-proposal-private-property-in-object": "^7.21.11",
"@testing-library/jest-dom": "^5.17.0",
"@testing-library/react": "^13.4.0",
"@testing-library/user-event": "^13.5.0",
"axios": "^1.6.2",
"js-cookie": "^3.0.5",
"react": "^18.2.0",
"react-dom": "^18.2.0",
"react-icons": "^4.12.0",
"react-loader-spinner": "^6.1.0",
"react-router-dom": "^5.3.4",
"react-scripts": "5.0.1",
"react-type-animation": "^3.2.0",
"web-vitals": "^2.1.4"
},
"scripts": {
"predeploy": "npm run build",
"deploy": "gh-pages -d build",
"start": "react-scripts start",
"build": "react-scripts build",
"test": "react-scripts test",
"eject": "react-scripts eject"
},
"eslintConfig": {
"extends": [
"react-app",
"react-app/jest"
]
},
"browserslist": {
"production": [
">0.2%",
"not dead",
"not op_mini all"
],
"development": [
"last 1 chrome version",
"last 1 firefox version",
"last 1 safari version"
]
},
"devDependencies": {
"gh-pages": "^6.2.0"
}
}
Frontend/build/index.html
<!doctype html><html lang="en"><head><meta charset="utf-8"/><link rel="icon" href="/project-
frontend/favicon.ico"/><meta name="viewport" content="width=device-width,initial-
scale=1"/><meta name="theme-color" content="#000000"/><meta name="Dev Store"
content="Web site created using create-react-app"/><link rel="apple-touch-icon" href="/project-
frontend/logo192.png"/><link rel="stylesheet"
href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-
TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
crossorigin="anonymous"/><script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
crossorigin="anonymous"></script><script
src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
crossorigin="anonymous"></script><link rel="manifest" href="/project-
frontend/manifest.json"/><title>Dev Store</title><script defer="defer" src="/project-
frontend/static/js/main.c4eddeea.js"></script><link href="/project-
frontend/static/css/main.94bc34bd.css" rel="stylesheet"></head><body><noscript>You need to
enable JavaScript to run this app.</noscript><div id="root"></div></body></html>
Frontend/public/index.html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#000000" />
<meta name="Dev Store" content="Web site created using create-react-app" />
<link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
<link
rel="stylesheet"
href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
crossorigin="anonymous" />
<script
src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
integrity="sha384-
DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
crossorigin="anonymous"></script>
<script
src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
integrity="sha384-
ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
crossorigin="anonymous"></script>
<!--
manifest.json provides metadata used when your web app is installed on a
user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-
manifest/
-->
<link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
<!--
Notice the use of %PUBLIC_URL% in the tags above.
It will be replaced with the URL of the `public` folder during the build.
Only files inside the `public` folder can be referenced from the HTML.
Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
work correctly both with client-side routing and a non-root public URL.
Learn how to configure a non-root public URL by running `npm run build`.
-->
<title>Dev Store</title>
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<div id="root"></div>
<!--
This HTML file is a template.
If you open it directly in the browser, you will see an empty page.
You can add webfonts, meta tags, or analytics to this file.
The build step will place the bundled scripts into the <body> tag.
To begin the development, run `npm start` or `yarn start`.
To create a production bundle, use `npm run build` or `yarn build`.
-->
</body>
</html>
BACKEND:
ServerApp/config/dbConnect.js
const mongoose = require('mongoose');
const ConnectDb = async () => {
try {
await
mongoose.connect("mongodb+srv://admin:Admin%401234@cluster0.zbool.mongodb.net/eComme
rce?retryWrites=true&w=majority&appName=Cluster0", {
useNewUrlParser: true,
useUnifiedTopology: true,
});
console.log('MongoDB Connected Successfully');
} catch (err) {
console.error('MongoDB Connection Error:', err.message);
process.exit(1); // Exit process on failure
}
};
module.exports = ConnectDb;
ServerApp/models/products.js
const mongoose = require('mongoose')
const ProductSchema = new mongoose.Schema({
id: Number,
productName: String,
image: String,
description: String,
price: Number,
specs: Object,
})
module.exports = mongoose.model('Products', ProductSchema)
ServerApp/models/users.js
const mongoose = require('mongoose')
const userSchema = new mongoose.Schema({
username: { type: String, required: true, unique: true },
email: { type: String, required: true, unique: true },
phone: { type: Number, required: true, unique: true },
password: { type: String, required: true },
})
module.exports = mongoose.model('Users', userSchema)
ServerApp/package.json
{
"name": "backend",
"version": "1.0.0",
"description": "",
"main": "index.js",
"scripts": {
"test": "echo \"Error: no test specified\" && exit 1",
"start": "node server.js",
"dev": "nodemon server",
"build": "webpack"
},
"author": "",
"license": "ISC",
"dependencies": {
"bcryptjs": "^2.4.3",
"cors": "^2.8.5",
"dotenv": "^16.4.5",
"express": "^4.18.2",
"jsonwebtoken": "^9.0.2",
"mongoose": "^8.0.3",
"nodemon": "^3.0.2"
}
}
ServerApp/server.js
require('dotenv').config();
const express = require('express');
const cors = require('cors');
const mongoose = require('mongoose');
const bcrypt = require('bcryptjs');
const jwtToken = require('jsonwebtoken');
const path = require('path');
const helmet = require('helmet'); // Security headers
const morgan = require('morgan'); // Logging
const mongoSanitize = require('express-mongo-sanitize'); // Sanitize inputs
const rateLimit = require('express-rate-limit'); // Rate limiting
// Import Models
const products = require('./models/products');
const userData = require('./models/users');
const app = express();
app.set('trust proxy', 1);
// const favicon = require('serve-favicon');
// app.use(favicon(path.join(__dirname, 'public', 'favicon.ico')));
// Middleware
app.use(express.json());
app.use(helmet());
app.use(mongoSanitize());
app.use(morgan('combined')); // Logs requests
app.use(cors({
origin: ['http://localhost:3000', 'https://ecommerce-fe-0jr6.onrender.com'],
credentials: true,
}));
// Rate Limiting
const apiLimiter = rateLimit({
windowMs: 15 * 60 * 1000, // 15 minutes
max: 100, // Limit each IP to 100 requests
message: 'Too many requests, please try again later.',
});
app.use('/api', apiLimiter);
// Environment Variables
const PORT = 3020;
const MONGO_URI =
"mongodb+srv://admin:Admin%401234@cluster0.zbool.mongodb.net/eCommerce?retryWrites=tru
e&w=majority&appName=Cluster0";
const MY_SECRET_TOKEN = 'eCommerce12062024';
// Connect to MongoDB
mongoose.connect(MONGO_URI, {
useNewUrlParser: true,
useUnifiedTopology: true,
})
.then(() => console.log('MongoDB Connected'))
.catch((err) => {
console.error('Database Connection Error:', err.message);
process.exit(1); // Exit process on failure
});
const fetchProducts = async () => {
try {
const products = await Product.find({});
console.log('Fetched Products:', products);
} catch (err) {
console.error('Error fetching products:', err.message);
}
};
mongoose.connection.once('open', () => {
console.log('MongoDB Connection Open');
fetchProducts();
app.listen(PORT, () => {
console.log(`Server running on http://localhost:${PORT}`);
});
});
// JWT Authorization Middleware
const authorization = (req, res, next) => {
const authHeader = req.headers['authorization'];
if (!authHeader) {
return res.status(401).send('Unauthorized');
}
const token = authHeader.split(' ')[1];
jwtToken.verify(token, MY_SECRET_TOKEN, (err) => {
if (err) {
return res.status(403).send('Forbidden');
}
next();
});
};
// Routes
app.get('/', (req, res) => {
res.send('Welcome to the Backend!');
});
app.post('/api/register', async (req, res) => {
try {
const { username, email, phone, password } = req.body;
// Check for existing user with the same phone number
const existingUser = await userData.findOne({ phone });
if (existingUser) {
return res.status(400).json({ message: 'Phone number already registered' });
}
// Hash the password
const hashedPassword = await bcrypt.hash(password, 10);
// Create and save the new user
const newUser = new userData({
username,
email,
phone,
password: hashedPassword,
});
await newUser.save();
res.status(201).json({ message: 'Registration successful!' });
} catch (error) {
console.error('Error in /api/register:', error.message);
// Handle duplicate key errors explicitly
if (error.code === 11000) {
return res.status(400).json({ message: 'Duplicate key error' });
}
res.status(500).json({ message: 'Internal Server Error' });
}
});
app.post('/api/login', async (req, res) => {
try {
const { username, password } = req.body;
const checkUser = await userData.findOne({ username });
if (!checkUser) {
return res.status(400).send('Invalid Username');
}
const isPasswordCorrect = await bcrypt.compare(password, checkUser.password);
if (!isPasswordCorrect) {
return res.status(400).send('Wrong Password');
}
const token = jwtToken.sign({ username }, MY_SECRET_TOKEN, { expiresIn: '1h' });
res.send({ status: 'ok', token });
} catch (error) {
console.error('Error in /api/login:', error.message);
res.status(500).send('Internal Server Error');
}
});
app.get('/api/products', async (req, res) => {
try {
const allProducts = await products.find({});
res.send(allProducts);
} catch (error) {
console.error('Error in /api/products:', error.message);
res.status(500).send('Internal Server Error');
}
});
app.get('/api/products/:id', authorization, async (req, res) => {
try {
const { id } = req.params;
const singleProduct = await products.findOne({ id: id.toString() });
if (!singleProduct) {
return res.status(404).send('Product Not Found');
}
res.send(singleProduct);
} catch (error) {
console.error('Error in /api/products/:id:', error.message);
res.status(500).send('Internal Server Error');
}
});
// Serve React Build Files
if (process.env.NODE_ENV === 'production') {
app.use(express.static(path.join(__dirname, 'frontend/build')));
app.get('*', (req, res) => {
res.sendFile(path.join(__dirname, 'frontend/build', 'index.html'));
});
}
// Error Handling Middleware
app.use((err, req, res, next) => {
console.error('Global Error Handler:', err.stack);
res.status(err.status || 500).send(err.message || 'Internal Server Error');
});
ServerApp/testConnection.js
require('dotenv').config();
const mongoose = require('mongoose');
const Product = require('./models/products');
// Connect to MongoDB
const MONGO_URI = process.env.MONGO_URI;
mongoose.connect(MONGO_URI, {
useNewUrlParser: true,
useUnifiedTopology: true,
})
.then(() => console.log('Connected to MongoDB'))
.catch((err) => console.error('MongoDB Connection Error:', err.message));
// Fetch Products
const fetchProducts = async () => {
try {
const products = await Product.find({});
console.log('Products:', products);
} catch (err) {
console.error('Error fetching products:', err.message);
} finally {
mongoose.connection.close(); // Close the connection after testing
}
};
fetchProducts();
